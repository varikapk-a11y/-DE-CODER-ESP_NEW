## для блока CODER>ESP_NEW
# Код для DeclareSection
// Переменные для хранения предыдущих значений датчиков
float old_f1= 0, old_f2 = 0, old_f3 = 0;
int old_i1= 0, old_i2 = 0, old_i3 = 0;
bool firstRun= true;
// Объявление функции (без тела, только сигнатура)
void sendSensorUpdate(String key, float value);

------------

// === ОПРЕДЕЛЕНИЕ ФУНКЦИИ ===
void sendSensorUpdate(String key, float value) {
    out_espnow_string = key + ":" + String(value, 2);
    out_debug_str = "Sent -> " + out_espnow_string;
}

// === ОСНОВНОЙ КОД ===
// ИНИЦИАЛИЗАЦИЯ ПРИ ПЕРВОМ ЗАПУСКЕ
if (firstRun) {
    old_f1 = in_sensor1_float;
    old_f2 = in_sensor2_float;
    old_f3 = in_sensor3_float;
    old_i1 = in_sensor1_int;
    old_i2 = in_sensor2_int;
    old_i3 = in_sensor3_int;
    firstRun = false;
    out_debug_str = "Coder INIT";
    return;
}

// ОСНОВНАЯ ЛОГИКА: ПРОВЕРЯЕМ ИЗМЕНЕНИЯ И ФОРМИРУЕМ СТРОКУ
if (in_trigger) {
    if (in_sensor1_float != old_f1) {
        sendSensorUpdate("F1", in_sensor1_float);
        old_f1 = in_sensor1_float;
        return;
    }
    if (in_sensor2_float != old_f2) {
        sendSensorUpdate("F2", in_sensor2_float);
        old_f2 = in_sensor2_float;
        return;
    }
    if (in_sensor3_float != old_f3) {
        sendSensorUpdate("F3", in_sensor3_float);
        old_f3 = in_sensor3_float;
        return;
    }
    if (in_sensor1_int != old_i1) {
        sendSensorUpdate("I1", (float)in_sensor1_int);
        old_i1 = in_sensor1_int;
        return;
    }
    if (in_sensor2_int != old_i2) {
        sendSensorUpdate("I2", (float)in_sensor2_int);
        old_i2 = in_sensor2_int;
        return;
    }
    if (in_sensor3_int != old_i3) {
        sendSensorUpdate("I3", (float)in_sensor3_int);
        old_i3 = in_sensor3_int;
        return;
    }
    out_debug_str = "No changes";
}

--------------------

# Входы-Выходы
Тип Имя Отображаемое имя Тип данных Вход in_sensor1_float Д1 (float) Float 
Вход in_sensor2_float Д2 (float) Float Вход in_sensor3_float Д3 (float) Float 
Вход in_sensor1_int Д4 (int) Integer Вход in_sensor2_int Д5 (int) Integer 
Вход in_sensor3_int Д6 (int) Integer Вход in_peer_mac MAC получателя String 
Вход in_trigger Триггер Boolean Выход out_debug_str данные для ESP-NOW String

Тип Имя (Name) Тип данных (Data Type) Вход in_espnow_string String 
Вход in_trigger Boolean Выход out_sensor1_float Float Выход out_sensor2_float Float 
Выход out_sensor3_float Float Выход out_sensor1_int Integer Выход out_sensor2_int Integer 
Выход out_sensor3_int Integer Выход out_debug_str String
